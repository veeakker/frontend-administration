{{page-title "Edit"}}

<div class="container">
  <h1>{{@model.label}}<small>, edit product detail</small></h1>

  <form {{on "submit" (e/pipe (e/prevent-default) (e/call @model "save"))}} class="row">
    <Ux::DetailsCard @editable={{true}} @resource={{@model}} class="col-12 col-md-8">
      <:title>Details</:title>
      <:body as |C|>
        <C.Property @property="plu" @label="PLU" />
        <C.Property @property="label" />
        <C.Property @property="altLabel" />
        <C.Property @property="description" />
        <C.Property @property="ingredientsText" @label="Ingredients" />
        <C.Property @property="allergensText" @label="Allergens" />
        <C.Property @property="nutricionDataText" @label="Nutricion data" />
        <C.Property @property="sortIndex" />
        <C.Property @property="isEnabled" @label="Published?" />
        <C.Property @property="productLabels">
          {{#each @model.productLabels as |uri|}}
            {{#let (product/label-info uri) as |label|}}
              <img src={{label.image}} alt={{label.label}} />
            {{/let}}
          {{/each}}
        </C.Property>
      </:body>
    </Ux::DetailsCard>
    <Ux::DetailsCard @editable={{true}} @resource={{@model}} class="col-12 col-md-4">
      <:title>Preview</:title>
      <:body as |C|>
        <C.Property @renderLabel={{false}} @property="thumbnail" />
      </:body>
    </Ux::DetailsCard>
    <Ux::DetailsCard @editable={{false}} @resource={{@model}} class="col-12 col-md-6">
      <:title>Prices</:title>
      <:body as |C|>
        <C.Card.Section @title="defaults">
          <C.Property @property="targetUnit" @label="Amount" />
          <C.Property @property="unitPrice" @label="Price" />
        </C.Card.Section>
        <C.Card.Section @title="Offers">
          <ul>
            {{#each @model.offerings as |offering|}}
              <li><Product::Price @offering={{offering}} /></li>
            {{/each}}
          </ul>
        </C.Card.Section>
      </:body>
    </Ux::DetailsCard>
    <Ui::Card @title="Product groups" class="col-12 col-md-6">
      <ul>
        {{#each @model.productGroups as |productGroup|}}
          <li>
            <Ux::Link @model={{productGroup}} />
          </li>
        {{/each}}
      </ul>
    </Ui::Card>
    <BsButton type="submit" @type="primary">Save</BsButton>
  </form>
</div>

{{outlet}}